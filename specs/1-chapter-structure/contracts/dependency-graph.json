{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Chapter Dependency Graph",
  "description": "Directed Acyclic Graph (DAG) of chapter prerequisites for 'When Code Learns to Walk'",
  "type": "object",
  "required": ["chapters", "dependencies", "metadata"],
  "properties": {
    "metadata": {
      "type": "object",
      "required": ["version", "generatedDate"],
      "properties": {
        "version": {
          "type": "string",
          "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
          "description": "Semantic version of this DAG"
        },
        "generatedDate": {
          "type": "string",
          "format": "date-time"
        },
        "totalChapters": {
          "type": "integer",
          "const": 13
        }
      }
    },
    "chapters": {
      "type": "array",
      "minItems": 13,
      "maxItems": 13,
      "items": {
        "type": "object",
        "required": ["id", "number", "title", "section"],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^ch[0-9]{2}$"
          },
          "number": {
            "type": "integer",
            "minimum": 1,
            "maximum": 13
          },
          "title": {
            "type": "string"
          },
          "section": {
            "type": "string",
            "enum": ["01-foundations", "02-core-implementations", "03-learning-systems", "04-advanced-systems"]
          }
        }
      }
    },
    "dependencies": {
      "type": "array",
      "description": "List of all prerequisite relationships",
      "items": {
        "type": "object",
        "required": ["chapter", "prerequisites"],
        "properties": {
          "chapter": {
            "type": "integer",
            "minimum": 1,
            "maximum": 13
          },
          "prerequisites": {
            "type": "array",
            "items": {
              "type": "integer",
              "minimum": 1,
              "maximum": 13
            },
            "description": "Chapters that must be read before this chapter (empty = no prerequisites)"
          },
          "rationale": {
            "type": "string",
            "description": "Why these prerequisites are needed"
          }
        }
      }
    },
    "structure": {
      "description": "Validated structure of the dependency graph",
      "type": "object",
      "properties": {
        "hasCycles": {
          "type": "boolean",
          "const": false,
          "description": "Must be acyclic (no circular dependencies)"
        },
        "isDAG": {
          "type": "boolean",
          "const": true,
          "description": "Is a Directed Acyclic Graph"
        },
        "topologicalOrder": {
          "type": "array",
          "items": {
            "type": "integer"
          },
          "minItems": 13,
          "maxItems": 13,
          "description": "Valid reading order (chapters can be read in this sequence)"
        }
      }
    },
    "parallelizationPaths": {
      "description": "Chapters that can be read in parallel",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "path": {
            "type": "array",
            "items": {
              "type": "integer"
            }
          },
          "description": {
            "type": "string"
          }
        }
      }
    },
    "readingPaths": {
      "description": "Recommended reading sequences for different learner types",
      "type": "object",
      "properties": {
        "sequential": {
          "type": "array",
          "items": {
            "type": "integer"
          },
          "description": "All chapters in order for complete learning"
        },
        "softwareEngineer": {
          "type": "array",
          "items": {
            "type": "integer"
          },
          "description": "Fast path for software engineers learning robotics"
        },
        "hardwareEngineer": {
          "type": "array",
          "items": {
            "type": "integer"
          },
          "description": "Fast path for control/robotics engineers learning ML"
        },
        "machinelearning": {
          "type": "array",
          "items": {
            "type": "integer"
          },
          "description": "Fast path for ML researchers"
        }
      }
    },
    "levelMapping": {
      "description": "Bloom's taxonomy progression across chapters",
      "type": "object",
      "properties": {
        "level1to2": {
          "type": "array",
          "items": {
            "type": "integer"
          },
          "description": "Remember/Understand (Chapters 1-3)"
        },
        "level3to4": {
          "type": "array",
          "items": {
            "type": "integer"
          },
          "description": "Apply/Analyze (Chapters 4-7)"
        },
        "level5to6": {
          "type": "array",
          "items": {
            "type": "integer"
          },
          "description": "Evaluate/Create (Chapters 8-13)"
        }
      }
    },
    "constraintCoverage": {
      "description": "Which chapters address each Physical AI constraint",
      "type": "object",
      "properties": {
        "physics": {
          "type": "array",
          "items": {
            "type": "integer"
          }
        },
        "latency": {
          "type": "array",
          "items": {
            "type": "integer"
          }
        },
        "safety": {
          "type": "array",
          "items": {
            "type": "integer"
          }
        },
        "energy": {
          "type": "array",
          "items": {
            "type": "integer"
          }
        },
        "simToReal": {
          "type": "array",
          "items": {
            "type": "integer"
          }
        }
      }
    },
    "validationResults": {
      "description": "Results of structural validation",
      "type": "object",
      "properties": {
        "allChaptersPresent": {
          "type": "boolean",
          "const": true,
          "description": "All 13 chapters defined exactly once"
        },
        "noCyclicDependencies": {
          "type": "boolean",
          "const": true,
          "description": "No chapter depends on itself directly or indirectly"
        },
        "validChapterNumbers": {
          "type": "boolean",
          "const": true,
          "description": "All references are to chapters 1-13"
        },
        "topologicalSortExists": {
          "type": "boolean",
          "const": true,
          "description": "DAG can be sorted topologically"
        }
      }
    }
  }
}
